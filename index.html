<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TazDesu - Streaming Anime Sub Indo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            font-family: 'Poppins', 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 100%);
            min-height: 100vh;
            color: #fff;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Neon effect */
        @keyframes neonPulse {
            0%, 100% {
                text-shadow: 0 0 5px #ff4d4d, 0 0 10px #ff4d4d, 0 0 15px #ff4d4d, 0 0 20px #ff0000;
            }
            50% {
                text-shadow: 0 0 10px #ff6b6b, 0 0 20px #ff6b6b, 0 0 30px #ff6b6b, 0 0 40px #ff3300;
            }
        }
        
        .neon-text {
            animation: neonPulse 1.5s ease-in-out infinite;
        }
        
        @keyframes neonBorder {
            0%, 100% {
                box-shadow: 0 0 5px #ff4d4d, 0 0 10px #ff4d4d, inset 0 0 5px #ff4d4d;
            }
            50% {
                box-shadow: 0 0 15px #ff6b6b, 0 0 25px #ff6b6b, inset 0 0 10px #ff6b6b;
            }
        }
        
        .neon-border {
            animation: neonBorder 2s ease-in-out infinite;
        }
        
        @keyframes neonGlow {
            0%, 100% {
                filter: drop-shadow(0 0 2px #ff4d4d) drop-shadow(0 0 5px #ff4d4d);
            }
            50% {
                filter: drop-shadow(0 0 5px #ff6b6b) drop-shadow(0 0 10px #ff6b6b) drop-shadow(0 0 15px #ff6b6b);
            }
        }
        
        .neon-glow {
            animation: neonGlow 2s ease-in-out infinite;
        }
        
        /* Moving neon line */
        .neon-line {
            position: relative;
            overflow: hidden;
        }
        
        .neon-line::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #ff4d4d, #ff8e8e, #ff4d4d, transparent);
            animation: neonMove 3s linear infinite;
        }
        
        @keyframes neonMove {
            0% { left: -50%; }
            100% { left: 150%; }
        }
        
        /* Floating particles */
        .particle {
            position: fixed;
            width: 2px;
            height: 2px;
            background: rgba(255, 77, 77, 0.3);
            border-radius: 50%;
            pointer-events: none;
            z-index: 0;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #ff4d4d 0%, #ff8e8e 100%);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #ff8e8e 0%, #ff4d4d 100%);
        }
        
        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes glowPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }
        
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        
        .animate-slide-in {
            animation: slideIn 0.6s ease-out forwards;
        }
        
        .animate-glow-pulse {
            animation: glowPulse 2s ease-in-out infinite;
        }
        
        /* Card hover effects */
        .anime-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 77, 77, 0.2);
        }
        
        .anime-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: #ff4d4d;
            box-shadow: 0 20px 40px rgba(255, 77, 77, 0.3);
        }
        
        .anime-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 77, 77, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .anime-card:hover::before {
            left: 100%;
        }
        
        .anime-card .poster {
            transition: transform 0.5s;
        }
        
        .anime-card:hover .poster {
            transform: scale(1.1);
        }
        
        /* Navbar glass effect with neon */
        .glass-nav {
            background: rgba(10, 10, 15, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 77, 77, 0.3);
            position: relative;
        }
        
        .glass-nav::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, #ff4d4d, #ff8e8e, #ff4d4d, transparent);
            animation: neonMove 3s linear infinite;
        }
        
        /* Loading animation */
        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid rgba(255, 77, 77, 0.1);
            border-bottom-color: #ff4d4d;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Active nav link */
        .nav-link {
            position: relative;
            overflow: hidden;
        }
        
        .nav-link.active {
            color: #ff4d4d;
        }
        
        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #ff4d4d, #ff8e8e);
            animation: neonMove 2s linear infinite;
        }
        
        /* Day selector buttons */
        .day-btn {
            transition: all 0.3s;
            border: 1px solid rgba(255, 77, 77, 0.3);
        }
        
        .day-btn.active {
            background: linear-gradient(135deg, #ff4d4d 0%, #ff8e8e 100%);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 0 15px #ff4d4d;
            border-color: transparent;
        }
        
        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: linear-gradient(135deg, #0f0c1f 0%, #1a1a2e 100%);
            border-radius: 20px;
            max-width: 1000px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
            border: 1px solid rgba(255, 77, 77, 0.5);
            position: relative;
        }
        
        .modal-content::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ff4d4d, #ff8e8e, #ff4d4d);
            border-radius: 22px;
            z-index: -1;
            animation: neonRotate 3s linear infinite;
            opacity: 0.5;
        }
        
        @keyframes neonRotate {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        /* Gradient text */
        .gradient-text {
            background: linear-gradient(135deg, #ff4d4d 0%, #ff8e8e 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Search input */
        .search-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 77, 77, 0.3);
            color: white;
        }
        
        .search-input:focus {
            border-color: #ff4d4d;
            box-shadow: 0 0 10px rgba(255, 77, 77, 0.3);
            outline: none;
        }
        
        /* Episode list scroll */
        .episode-list {
            max-height: 250px;
            overflow-y: auto;
            padding-right: 8px;
        }
        
        .episode-list::-webkit-scrollbar {
            width: 4px;
        }
        
        /* Episode item */
        .episode-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 77, 77, 0.2);
            transition: all 0.3s;
        }
        
        .episode-item:hover {
            background: rgba(255, 77, 77, 0.1);
            border-color: #ff4d4d;
            transform: translateX(5px);
        }
        
        /* Recommended anime */
        .recommended-item {
            transition: all 0.3s;
            border: 1px solid rgba(255, 77, 77, 0.2);
        }
        
        .recommended-item:hover {
            border-color: #ff4d4d;
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 77, 77, 0.3);
        }
        
        /* Genre tags */
        .genre-tag {
            background: rgba(255, 77, 77, 0.1);
            border: 1px solid rgba(255, 77, 77, 0.3);
            transition: all 0.3s;
        }
        
        .genre-tag:hover {
            background: rgba(255, 77, 77, 0.3);
            border-color: #ff4d4d;
            transform: translateY(-2px);
        }
        
        /* Play button */
        .play-button {
            background: linear-gradient(135deg, #ff4d4d 0%, #ff8e8e 100%);
            box-shadow: 0 0 15px #ff4d4d;
            transition: all 0.3s;
        }
        
        .play-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px #ff4d4d;
        }
    </style>
</head>
<body class="overflow-x-hidden">
    <!-- Floating particles -->
    <div id="particles"></div>

    <!-- Navbar -->
    <nav class="glass-nav fixed w-full z-50 px-6 py-4 animate-slide-in">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-2 cursor-pointer group" onclick="loadPage('home')">
                <i class="fas fa-tv text-3xl text-red-400 neon-glow"></i>
                <span class="text-2xl font-bold gradient-text neon-text">TazDesu</span>
            </div>
            
            <div class="hidden md:flex space-x-1">
                <button onclick="loadPage('home')" class="nav-link px-4 py-2 rounded-lg transition-all duration-300 hover:text-red-400" id="nav-home">
                    <i class="fas fa-home mr-2"></i>Home
                </button>
                <button onclick="loadPage('ongoing')" class="nav-link px-4 py-2 rounded-lg transition-all duration-300 hover:text-red-400" id="nav-ongoing">
                    <i class="fas fa-play-circle mr-2"></i>Ongoing
                </button>
                <button onclick="loadPage('completed')" class="nav-link px-4 py-2 rounded-lg transition-all duration-300 hover:text-red-400" id="nav-completed">
                    <i class="fas fa-check-circle mr-2"></i>Completed
                </button>
                <button onclick="loadPage('schedule')" class="nav-link px-4 py-2 rounded-lg transition-all duration-300 hover:text-red-400" id="nav-schedule">
                    <i class="fas fa-calendar mr-2"></i>Schedule
                </button>
                <button onclick="loadPage('genre')" class="nav-link px-4 py-2 rounded-lg transition-all duration-300 hover:text-red-400" id="nav-genre">
                    <i class="fas fa-tags mr-2"></i>Genre
                </button>
                <button onclick="loadPage('anime-list')" class="nav-link px-4 py-2 rounded-lg transition-all duration-300 hover:text-red-400" id="nav-anime-list">
                    <i class="fas fa-list mr-2"></i>Anime List
                </button>
            </div>
            
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <input type="text" id="searchInput" placeholder="Cari anime..." class="search-input rounded-lg px-4 py-2 pl-10 focus:outline-none transition-all w-64 text-white">
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>
                <button onclick="searchAnime()" class="play-button px-4 py-2 rounded-lg transition-all">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 pt-24 pb-12 relative z-10">
        <div id="content" class="animate-slide-in">
            <!-- Content will be loaded here -->
            <div class="flex justify-center items-center h-96">
                <div class="loader"></div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="glass-nav mt-12 py-6 relative z-10">
        <div class="container mx-auto px-6 text-center text-gray-400">
            <p>Â© 2026 TazDesu - Streaming Anime Sub Indo. All rights reserved.</p>
            <p class="text-sm mt-2">Data provided by OtakuDesu API</p>
        </div>
    </footer>

    <!-- Modal for anime detail -->
    <div id="animeModal" class="modal-overlay" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div id="modalContent" class="p-6">
                <!-- Modal content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // ðŸ”¥ UBAH INI KE LOCALHOST:3001
        const API_BASE = 'http://localhost:3001/otakudesu';
        let currentPage = 'home';
        let currentParams = {};
        
        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animation = `float ${5 + Math.random() * 5}s ease-in-out infinite`;
                particle.style.animationDelay = Math.random() * 5 + 's';
                particle.style.background = `rgba(255, ${77 + Math.random() * 100}, ${77 + Math.random() * 100}, ${0.1 + Math.random() * 0.3})`;
                particle.style.width = `${2 + Math.random() * 4}px`;
                particle.style.height = particle.style.width;
                particlesContainer.appendChild(particle);
            }
        }
        
        createParticles();
        
        // Set active nav
        function setActiveNav(page) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            const navElement = document.getElementById(`nav-${page}`);
            if (navElement) {
                navElement.classList.add('active');
            }
        }

        // Load page based on selection
        async function loadPage(page, params = {}) {
            currentPage = page;
            currentParams = params;
            setActiveNav(page);
            
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="flex justify-center items-center h-96">
                    <div class="loader"></div>
                </div>
            `;
            
            try {
                let data;
                switch(page) {
                    case 'home':
                        data = await fetchAPI('/home');
                        renderHome(data);
                        break;
                    case 'ongoing':
                        data = await fetchAPI('/ongoing', params);
                        renderOngoing(data);
                        break;
                    case 'completed':
                        data = await fetchAPI('/completed', params);
                        renderCompleted(data);
                        break;
                    case 'schedule':
                        data = await fetchAPI('/schedule');
                        renderSchedule(data);
                        break;
                    case 'genre':
                        data = await fetchAPI('/genre');
                        renderGenre(data);
                        break;
                    case 'anime-list':
                        data = await fetchAPI('/anime');
                        renderAnimeList(data);
                        break;
                    case 'search':
                        data = await fetchAPI('/search', { q: params.q });
                        renderSearch(data, params.q);
                        break;
                }
            } catch (error) {
                console.error('Error loading page:', error);
                content.innerHTML = `
                    <div class="text-center py-20">
                        <i class="fas fa-exclamation-circle text-6xl text-red-500 mb-4"></i>
                        <h2 class="text-2xl font-bold mb-2">Error Loading Data</h2>
                        <p class="text-gray-400 mb-4">${error.message}</p>
                        <button onclick="loadPage('home')" class="mt-6 play-button px-6 py-3 rounded-lg transition-all">
                            <i class="fas fa-home mr-2"></i>Back to Home
                        </button>
                    </div>
                `;
            }
        }

        // Fetch API with error handling
        async function fetchAPI(endpoint, params = {}) {
            let url = `${API_BASE}${endpoint}`;
            if (Object.keys(params).length > 0) {
                const queryString = new URLSearchParams(params).toString();
                url += `?${queryString}`;
            }
            
            console.log('Fetching:', url);
            
            try {
                const response = await fetch(url);
                const result = await response.json();
                
                console.log('Response:', result);
                
                if (!response.ok) {
                    throw new Error(`HTTP Error: ${response.status}`);
                }
                
                if (result.statusCode !== 200) {
                    throw new Error(result.message || 'Unknown error');
                }
                
                return result.data;
            } catch (error) {
                console.error('Fetch error:', error);
                throw new Error(`Gagal mengambil data: ${error.message}`);
            }
        }

        // Search function
        async function searchAnime() {
            const query = document.getElementById('searchInput').value.trim();
            if (query) {
                await loadPage('search', { q: query });
            }
        }

        // Enter key on search
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchAnime();
            }
        });

        // Modal functions
        function openModal() {
            document.getElementById('animeModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('animeModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Load anime detail
        async function loadAnimeDetail(animeId) {
            try {
                const modalContent = document.getElementById('modalContent');
                modalContent.innerHTML = `
                    <div class="flex justify-center items-center h-64">
                        <div class="loader"></div>
                    </div>
                `;
                openModal();
                
                console.log('Fetching anime detail:', animeId);
                
                const response = await fetch(`${API_BASE}/anime/${animeId}`);
                const result = await response.json();
                
                console.log('Detail response:', result);
                
                if (!response.ok || result.statusCode !== 200) {
                    throw new Error(result.message || 'Gagal mengambil data anime');
                }
                
                // ðŸ”¥ FIX: Ambil data.details karena response-nya punya objek "details"
                renderAnimeDetailModal(result.data);
                
            } catch (error) {
                console.error('Error loading anime detail:', error);
                
                document.getElementById('modalContent').innerHTML = `
                    <div class="text-center py-10">
                        <i class="fas fa-exclamation-circle text-4xl text-red-500 mb-3"></i>
                        <p class="text-gray-400 mb-4">${error.message}</p>
                        <p class="text-sm text-gray-500 mb-4">Anime ID: ${animeId}</p>
                        <div class="flex justify-center space-x-3">
                            <button onclick="loadAnimeDetail('${animeId}')" class="play-button px-4 py-2 rounded-lg transition-all">
                                <i class="fas fa-sync-alt mr-2"></i>Coba Lagi
                            </button>
                            <button onclick="closeModal()" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded-lg transition-all">
                                <i class="fas fa-times mr-2"></i>Tutup
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        // Render Anime Detail di Modal
        function renderAnimeDetailModal(data) {
            const modalContent = document.getElementById('modalContent');
            
            // ðŸ”¥ FIX: Data detail ada di dalam properti "details"
            const details = data.details || data;
            
            // Fungsi untuk memformat data dengan aman
            const getValue = (value, defaultValue = '-') => {
                return value && value !== '' ? value : defaultValue;
            };
            
            const getArray = (arr) => {
                return Array.isArray(arr) ? arr : [];
            };
            
            modalContent.innerHTML = `
                <div class="relative">
                    <button onclick="closeModal()" class="absolute top-0 right-0 text-gray-400 hover:text-white text-2xl z-10 hover:scale-110 transition-all">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <div class="flex flex-col lg:flex-row gap-8">
                        <div class="lg:w-1/3">
                            <div class="relative group">
                                <img src="${getValue(details.poster, 'https://via.placeholder.com/300x400')}" 
                                     alt="${getValue(details.title)}" 
                                     class="w-full rounded-2xl shadow-2xl border-2 border-red-500/30 group-hover:border-red-500 transition-all"
                                     onerror="this.src='https://via.placeholder.com/300x400'">
                                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"></div>
                            </div>
                            
                            ${details.batch ? `
                                <div class="mt-4">
                                    <a href="${details.batch}" target="_blank" class="play-button w-full px-4 py-3 rounded-xl flex items-center justify-center space-x-2">
                                        <i class="fas fa-download"></i>
                                        <span>Download Batch</span>
                                    </a>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="lg:w-2/3">
                            <h2 class="text-3xl font-bold mb-4 gradient-text neon-text">${getValue(details.title)}</h2>
                            
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 text-sm mb-6 bg-black/30 p-4 rounded-xl border border-red-500/20">
                                ${details.japanese ? `
                                    <div class="neon-line">
                                        <span class="text-gray-400 block text-xs">Japanese</span>
                                        <span class="font-semibold">${details.japanese}</span>
                                    </div>
                                ` : ''}
                                ${details.score ? `
                                    <div>
                                        <span class="text-gray-400 block text-xs">Score</span>
                                        <span class="font-semibold text-yellow-400">${details.score}</span>
                                    </div>
                                ` : ''}
                                ${details.type ? `
                                    <div>
                                        <span class="text-gray-400 block text-xs">Type</span>
                                        <span class="font-semibold">${details.type}</span>
                                    </div>
                                ` : ''}
                                ${details.status ? `
                                    <div>
                                        <span class="text-gray-400 block text-xs">Status</span>
                                        <span class="font-semibold ${details.status === 'Ongoing' ? 'text-green-400' : 'text-blue-400'}">${details.status}</span>
                                    </div>
                                ` : ''}
                                ${details.episodes ? `
                                    <div>
                                        <span class="text-gray-400 block text-xs">Episodes</span>
                                        <span class="font-semibold">${details.episodes}</span>
                                    </div>
                                ` : ''}
                                ${details.duration ? `
                                    <div>
                                        <span class="text-gray-400 block text-xs">Duration</span>
                                        <span class="font-semibold">${details.duration}</span>
                                    </div>
                                ` : ''}
                                ${details.aired ? `
                                    <div>
                                        <span class="text-gray-400 block text-xs">Aired</span>
                                        <span class="font-semibold">${details.aired}</span>
                                    </div>
                                ` : ''}
                                ${details.studios ? `
                                    <div>
                                        <span class="text-gray-400 block text-xs">Studio</span>
                                        <span class="font-semibold">${details.studios}</span>
                                    </div>
                                ` : ''}
                            </div>
                            
                            ${getArray(details.genreList || details.genres).length > 0 ? `
                                <div class="mb-6">
                                    <h3 class="font-semibold mb-3 flex items-center">
                                        <i class="fas fa-tags text-red-400 mr-2"></i>
                                        Genres
                                    </h3>
                                    <div class="flex flex-wrap gap-2">
                                        ${getArray(details.genreList || details.genres).map(genre => {
                                            const genreTitle = genre.title || genre;
                                            const genreId = genre.genreId || (typeof genre === 'string' ? genre.toLowerCase() : '');
                                            return `
                                                <span onclick="loadGenreAnime('${genreId}')" 
                                                      class="genre-tag px-4 py-2 rounded-full text-xs cursor-pointer">
                                                    ${genreTitle}
                                                </span>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>
                            ` : ''}
                            
                            ${details.synopsis?.paragraphList?.length > 0 ? `
                                <div class="mb-6">
                                    <h3 class="font-semibold mb-3 flex items-center">
                                        <i class="fas fa-book-open text-red-400 mr-2"></i>
                                        Synopsis
                                    </h3>
                                    <div class="text-gray-300 text-sm leading-relaxed max-h-40 overflow-y-auto pr-2 bg-black/20 p-4 rounded-xl border border-red-500/10">
                                        ${details.synopsis.paragraphList.map(p => `<p class="mb-2">${p}</p>`).join('')}
                                    </div>
                                </div>
                            ` : details.synopsis && typeof details.synopsis === 'string' ? `
                                <div class="mb-6">
                                    <h3 class="font-semibold mb-3 flex items-center">
                                        <i class="fas fa-book-open text-red-400 mr-2"></i>
                                        Synopsis
                                    </h3>
                                    <p class="text-gray-300 text-sm leading-relaxed max-h-40 overflow-y-auto pr-2 bg-black/20 p-4 rounded-xl border border-red-500/10">
                                        ${details.synopsis}
                                    </p>
                                </div>
                            ` : ''}
                            
                            ${details.episodeList && details.episodeList.length > 0 ? `
                                <div class="mb-6">
                                    <h3 class="font-semibold mb-3 flex items-center">
                                        <i class="fas fa-list text-red-400 mr-2"></i>
                                        Episode List
                                    </h3>
                                    <div class="episode-list grid grid-cols-2 md:grid-cols-3 gap-2">
                                        ${details.episodeList.map(ep => `
                                            <div class="episode-item p-3 rounded-lg text-sm cursor-pointer flex items-center space-x-2"
                                                 onclick="loadEpisode('${ep.episodeId}')">
                                                <i class="fas fa-play-circle text-red-400"></i>
                                                <span>Episode ${ep.title}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                            
                            ${details.recommendedAnimeList && details.recommendedAnimeList.length > 0 ? `
                                <div>
                                    <h3 class="font-semibold mb-3 flex items-center">
                                        <i class="fas fa-thumbs-up text-red-400 mr-2"></i>
                                        Recommended
                                    </h3>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        ${details.recommendedAnimeList.slice(0, 4).map(rec => `
                                            <div class="recommended-item bg-black/30 p-2 rounded-lg cursor-pointer text-center"
                                                 onclick="loadAnimeDetail('${rec.animeId}')">
                                                <img src="${rec.poster}" alt="${rec.title}" class="w-full h-24 object-cover rounded-lg mb-2">
                                                <p class="text-xs line-clamp-2">${rec.title}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        // Fungsi untuk load episode
        window.loadEpisode = (episodeId) => {
            window.open(`https://otakudesu.best/episode/${episodeId}/`, '_blank');
        };

        // Render Home Page
        function renderHome(data) {
            const content = document.getElementById('content');
            
            const heroAnime = data.ongoing?.animeList?.[0] || { poster: '', title: 'Welcome to TazDesu' };
            
            content.innerHTML = `
                <div class="space-y-12">
                    <!-- Hero Section with Neon -->
                    <div class="relative rounded-3xl overflow-hidden h-96 animate-slide-in group">
                        <div class="absolute inset-0 bg-gradient-to-r from-red-900/90 to-red-800/90"></div>
                        <img src="${heroAnime.poster || 'https://via.placeholder.com/1200x400'}" alt="Hero" class="w-full h-full object-cover mix-blend-overlay">
                        <div class="absolute inset-0 flex items-center">
                            <div class="px-12">
                                <h1 class="text-5xl md:text-6xl font-bold mb-4 animate-float gradient-text neon-text">Welcome to TazDesu</h1>
                                <p class="text-xl text-gray-300 mb-6">Streaming Anime Subtitle Indonesia Terlengkap</p>
                                <div class="flex space-x-4">
                                    <button onclick="loadPage('ongoing')" class="play-button px-6 py-3 rounded-lg transition-all">
                                        <i class="fas fa-play mr-2"></i>Ongoing Anime
                                    </button>
                                    <button onclick="loadPage('completed')" class="bg-red-400/20 hover:bg-red-400/30 px-6 py-3 rounded-lg transition-all border border-red-400/30">
                                        <i class="fas fa-check mr-2"></i>Completed Anime
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-red-500 to-transparent animate-glow-pulse"></div>
                    </div>

                    <!-- Ongoing Anime Section -->
                    ${data.ongoing && data.ongoing.animeList ? `
                        <div class="animate-slide-in-delay-1">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-bold gradient-text flex items-center">
                                    <i class="fas fa-play-circle mr-2 text-red-400"></i>
                                    <span class="neon-line pb-1">Ongoing Anime</span>
                                </h2>
                                <button onclick="loadPage('ongoing')" class="text-red-400 hover:text-red-300 transition-all group">
                                    View All <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
                                </button>
                            </div>
                            
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
                                ${data.ongoing.animeList.slice(0, 10).map(anime => `
                                    <div class="anime-card rounded-xl overflow-hidden cursor-pointer" onclick="loadAnimeDetail('${anime.animeId}')">
                                        <div class="relative overflow-hidden h-48">
                                            <img src="${anime.poster}" alt="${anime.title}" class="poster w-full h-full object-cover">
                                            <div class="absolute top-2 right-2 bg-red-600 text-xs px-2 py-1 rounded-full">
                                                ${anime.episodes || '?'}
                                            </div>
                                            <div class="absolute bottom-2 left-2 bg-black/70 text-xs px-2 py-1 rounded-full border border-red-500/30">
                                                ${anime.releaseDay || '-'}
                                            </div>
                                        </div>
                                        <div class="p-4">
                                            <h3 class="font-semibold mb-2 line-clamp-2 text-sm">${anime.title}</h3>
                                            <p class="text-xs text-gray-400">${anime.latestReleaseDate || ''}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}

                    <!-- Completed Anime Section -->
                    ${data.completed && data.completed.animeList ? `
                        <div class="animate-slide-in-delay-2">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-bold gradient-text flex items-center">
                                    <i class="fas fa-check-circle mr-2 text-red-400"></i>
                                    <span class="neon-line pb-1">Completed Anime</span>
                                </h2>
                                <button onclick="loadPage('completed')" class="text-red-400 hover:text-red-300 transition-all group">
                                    View All <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
                                </button>
                            </div>
                            
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
                                ${data.completed.animeList.slice(0, 10).map(anime => `
                                    <div class="anime-card rounded-xl overflow-hidden cursor-pointer" onclick="loadAnimeDetail('${anime.animeId}')">
                                        <div class="relative overflow-hidden h-48">
                                            <img src="${anime.poster}" alt="${anime.title}" class="poster w-full h-full object-cover">
                                            <div class="absolute top-2 right-2 bg-red-400 text-xs px-2 py-1 rounded-full">
                                                ${anime.episodes || '?'}
                                            </div>
                                            <div class="absolute bottom-2 left-2 bg-black/70 text-xs px-2 py-1 rounded-full border border-red-500/30">
                                                ${anime.score || '-'}
                                            </div>
                                        </div>
                                        <div class="p-4">
                                            <h3 class="font-semibold mb-2 line-clamp-2 text-sm">${anime.title}</h3>
                                            <p class="text-xs text-gray-400">${anime.lastReleaseDate || ''}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // Render Ongoing Page
        function renderOngoing(data) {
            const content = document.getElementById('content');
            const pagination = data.pagination || { currentPage: 1, hasPrevPage: false, hasNextPage: false, totalPages: 1 };
            
            content.innerHTML = `
                <div class="animate-slide-in">
                    <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                        <h1 class="text-3xl font-bold gradient-text flex items-center">
                            <i class="fas fa-play-circle mr-2 text-red-400"></i>
                            <span class="neon-text">Ongoing Anime</span>
                        </h1>
                        <div class="flex space-x-2">
                            ${pagination.hasPrevPage ? `
                                <button onclick="loadPage('ongoing', { page: ${pagination.currentPage - 1} })" class="bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg transition-all border border-red-500/30">
                                    <i class="fas fa-chevron-left"></i> Prev
                                </button>
                            ` : ''}
                            <span class="bg-white/10 px-4 py-2 rounded-lg border border-red-500/30">Page ${pagination.currentPage} of ${pagination.totalPages}</span>
                            ${pagination.hasNextPage ? `
                                <button onclick="loadPage('ongoing', { page: ${pagination.currentPage + 1} })" class="bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg transition-all border border-red-500/30">
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
                        ${(data.animeList || []).map(anime => `
                            <div class="anime-card rounded-xl overflow-hidden cursor-pointer" onclick="loadAnimeDetail('${anime.animeId}')">
                                <div class="relative overflow-hidden h-48">
                                    <img src="${anime.poster}" alt="${anime.title}" class="poster w-full h-full object-cover">
                                    <div class="absolute top-2 right-2 bg-red-600 text-xs px-2 py-1 rounded-full">
                                        ${anime.episodes || '?'}
                                    </div>
                                    <div class="absolute bottom-2 left-2 bg-black/70 text-xs px-2 py-1 rounded-full border border-red-500/30">
                                        ${anime.releaseDay || '-'}
                                    </div>
                                </div>
                                <div class="p-4">
                                    <h3 class="font-semibold mb-2 line-clamp-2 text-sm">${anime.title}</h3>
                                    <p class="text-xs text-gray-400">${anime.latestReleaseDate || ''}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Render Completed Page
        function renderCompleted(data) {
            const content = document.getElementById('content');
            const pagination = data.pagination || { currentPage: 1, hasPrevPage: false, hasNextPage: false, totalPages: 1 };
            
            content.innerHTML = `
                <div class="animate-slide-in">
                    <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                        <h1 class="text-3xl font-bold gradient-text flex items-center">
                            <i class="fas fa-check-circle mr-2 text-red-400"></i>
                            <span class="neon-text">Completed Anime</span>
                        </h1>
                        <div class="flex space-x-2">
                            ${pagination.hasPrevPage ? `
                                <button onclick="loadPage('completed', { page: ${pagination.currentPage - 1} })" class="bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg transition-all border border-red-500/30">
                                    <i class="fas fa-chevron-left"></i> Prev
                                </button>
                            ` : ''}
                            <span class="bg-white/10 px-4 py-2 rounded-lg border border-red-500/30">Page ${pagination.currentPage} of ${pagination.totalPages}</span>
                            ${pagination.hasNextPage ? `
                                <button onclick="loadPage('completed', { page: ${pagination.currentPage + 1} })" class="bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg transition-all border border-red-500/30">
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
                        ${(data.animeList || []).map(anime => `
                            <div class="anime-card rounded-xl overflow-hidden cursor-pointer" onclick="loadAnimeDetail('${anime.animeId}')">
                                <div class="relative overflow-hidden h-48">
                                    <img src="${anime.poster}" alt="${anime.title}" class="poster w-full h-full object-cover">
                                    <div class="absolute top-2 right-2 bg-red-400 text-xs px-2 py-1 rounded-full">
                                        ${anime.episodes || '?'}
                                    </div>
                                    <div class="absolute bottom-2 left-2 bg-black/70 text-xs px-2 py-1 rounded-full border border-red-500/30">
                                        ${anime.score || '-'}
                                    </div>
                                </div>
                                <div class="p-4">
                                    <h3 class="font-semibold mb-2 line-clamp-2 text-sm">${anime.title}</h3>
                                    <p class="text-xs text-gray-400">${anime.lastReleaseDate || ''}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Render Schedule Page
        function renderSchedule(data) {
            const content = document.getElementById('content');
            const days = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Minggu', 'Random'];
            let activeDay = days[0];
            
            content.innerHTML = `
                <div class="animate-slide-in">
                    <h1 class="text-3xl font-bold gradient-text mb-8 flex items-center">
                        <i class="fas fa-calendar mr-2 text-red-400"></i>
                        <span class="neon-text">Release Schedule</span>
                    </h1>
                    
                    <div class="flex flex-wrap gap-2 mb-8">
                        ${days.map(day => `
                            <button class="day-btn px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 transition-all ${day === activeDay ? 'active' : ''}" onclick="filterSchedule('${day}')">
                                ${day}
                            </button>
                        `).join('')}
                    </div>
                    
                    <div id="schedule-content">
                        ${renderScheduleDay(data, activeDay)}
                    </div>
                </div>
            `;
            
            window.filterSchedule = (day) => {
                document.querySelectorAll('.day-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.textContent.trim() === day) {
                        btn.classList.add('active');
                    }
                });
                document.getElementById('schedule-content').innerHTML = renderScheduleDay(data, day);
            };
        }

        function renderScheduleDay(data, day) {
            const schedule = (data.scheduleList || []).find(s => s.title === day);
            if (!schedule || !schedule.animeList || schedule.animeList.length === 0) {
                return '<p class="text-gray-400 text-center py-10">No schedule for this day</p>';
            }
            
            return `
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    ${schedule.animeList.map(anime => `
                        <div class="bg-white/5 rounded-lg p-4 hover:bg-white/10 hover:border-red-500/50 transition-all cursor-pointer border border-red-500/20" onclick="loadAnimeDetail('${anime.animeId}')">
                            <h3 class="font-semibold">${anime.title}</h3>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Render Genre Page
        function renderGenre(data) {
            const content = document.getElementById('content');
            
            content.innerHTML = `
                <div class="animate-slide-in">
                    <h1 class="text-3xl font-bold gradient-text mb-8 flex items-center">
                        <i class="fas fa-tags mr-2 text-red-400"></i>
                        <span class="neon-text">Anime Genres</span>
                    </h1>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        ${(data.genreList || []).map(genre => `
                            <div class="genre-tag bg-white/5 rounded-lg p-4 hover:bg-white/10 hover:scale-105 transition-all cursor-pointer text-center" onclick="loadGenreAnime('${genre.genreId}')">
                                <h3 class="font-semibold">${genre.title}</h3>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Load genre anime
        window.loadGenreAnime = async (genreId) => {
            try {
                const data = await fetchAPI(`/genre/${genreId}`);
                alert(`âœ… Found ${data.animeList?.length || 0} anime in ${genreId} genre!`);
                console.log('Genre anime:', data);
            } catch (error) {
                alert('Error loading genre anime: ' + error.message);
            }
        };

        // Render Anime List Page
        function renderAnimeList(data) {
            const content = document.getElementById('content');
            
            content.innerHTML = `
                <div class="animate-slide-in">
                    <h1 class="text-3xl font-bold gradient-text mb-8 flex items-center">
                        <i class="fas fa-list mr-2 text-red-400"></i>
                        <span class="neon-text">All Anime List</span>
                    </h1>
                    
                    <div class="space-y-8">
                        ${(data.list || []).map(group => `
                            <div>
                                <h2 class="text-2xl font-bold mb-4 text-red-400 border-b border-red-500/30 pb-2">${group.startWith}</h2>
                                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                                    ${(group.animeList || []).map(anime => `
                                        <div class="bg-white/5 rounded-lg p-3 hover:bg-white/10 hover:scale-105 hover:border-red-500/50 transition-all cursor-pointer text-sm border border-red-500/20" 
                                             onclick="loadAnimeDetail('${anime.animeId}')">
                                            <i class="fas fa-play-circle mr-2 text-red-400 text-xs"></i>
                                            ${anime.title}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Render Search Results
        function renderSearch(data, query) {
            const content = document.getElementById('content');
            const animeList = data.animeList || [];
            
            content.innerHTML = `
                <div class="animate-slide-in">
                    <h1 class="text-3xl font-bold gradient-text mb-8 flex items-center">
                        <i class="fas fa-search mr-2 text-red-400"></i>
                        <span class="neon-text">Search Results for "${query}"</span>
                    </h1>
                    
                    ${animeList.length > 0 ? `
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
                            ${animeList.map(anime => `
                                <div class="anime-card rounded-xl overflow-hidden cursor-pointer" onclick="loadAnimeDetail('${anime.animeId}')">
                                    <div class="relative overflow-hidden h-48">
                                        <img src="${anime.poster}" alt="${anime.title}" class="poster w-full h-full object-cover">
                                    </div>
                                    <div class="p-4">
                                        <h3 class="font-semibold mb-2 line-clamp-2 text-sm">${anime.title}</h3>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div class="text-center py-20">
                            <i class="fas fa-search text-6xl text-gray-600 mb-4"></i>
                            <h2 class="text-2xl font-bold mb-2">No Results Found</h2>
                            <p class="text-gray-400">Try searching with different keywords</p>
                        </div>
                    `}
                </div>
            `;
        }

        // Load home page on initial load
        window.onload = () => {
            loadPage('home');
        };
    </script>
</body>
</html>